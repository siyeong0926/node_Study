<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="/main.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="grey-bg">

<!--ì¬ì‚¬ìš©ì´ ë§ì€ ê²ƒë“¤ì€ ejs íŒŒì¼ì— ë§Œë“¤ì–´ì„œ include í•˜ë©´ ë” í¸í•˜ë‹¤-->
<%- include('nav.ejs')%>

<!--sever ì—ì„œ ì‘ì„±í•œ ejs ì¨ì„œ html ì•ˆì— ì„œë²„ ë°ì´í„°ë¥¼ ê½‚ì•„ë„£ìŒ -->
<!--    <%= JSON.stringify(ê¸€ëª©ë¡)%>-->
<!-- JSON ìœ¼ë¡œ ì•ˆí•˜ë©´ Array, Object ê°€ ê¹¨ì ¸ì„œ ë“±ë¡ë¨-->

<div class="white-bg">


<!--     ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²•ì—ëŠ” <%%> ìš”ê±¸ ì‚¬ìš© í•´ì•¼í•¨-->
    <%for (let i = 0; i < ê¸€ëª©ë¡.length; i++){ %>
    <div class="list-box">
            <h4>

                <a href="/detail/<%= ê¸€ëª©ë¡[i]._id %>">
                    <%= ê¸€ëª©ë¡[i].title%>
                </a>

                <a href="/edit/<%= ê¸€ëª©ë¡[i]._id %>">ğŸ“</a>

                <span class="delete" data-id="<%= ê¸€ëª©ë¡[i]._id %>">ğŸ—‘ï¸</span>
            </h4>
        <%}%>
    </div>

    <a href="/list/next/<%= ê¸€ëª©ë¡[ê¸€ëª©ë¡.length-1]._id%>">ë‹¤ìŒ</a>


</div>

<script>

    document.querySelectorAll('.delete')[1].addEventListener('click', function(e) {
        fetch('/delete?docid=' + e.target.dataset.id, {
            method: 'DELETE'
        })
            .then((r) => r.text())  // ì„œë²„ì˜ ì‘ë‹µì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜
            .then((r) => {console.log(r);  // ì„œë²„ì˜ ì‘ë‹µì„ ì½˜ì†”ì— ì¶œë ¥
            })
            .catch(error => {
                console.error('Fetch error: ', error);
            });
    });

</script>

</body>
</html>